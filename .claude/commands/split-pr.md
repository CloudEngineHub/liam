---
description: Split a large pull request into smaller, focused PRs following skeleton review, TDD, and template compliance best practices
---

## Core Principles

### Skeleton Review Approach
- **First PR**: Implement basic structure/interfaces only for design review
  - Include type definitions, interfaces, empty method signatures
  - Add basic file structure and architectural decisions
  - Enable reviewers to understand overall design before implementation details
  - Reference: https://note.com/knowledgework/n/n50fc54509dd5
- **Subsequent PRs**: Add detailed implementation incrementally
- Focus on architectural feedback in early stages

### TDD-Based Splitting Strategy
- Pair small features with corresponding small tests in each PR
- Follow test pyramid principles: unit tests → integration tests → minimal e2e tests
- Each PR should be independently testable and reviewable
- Maintain red-green-refactor cycle across PR boundaries

### Size Constraints
- **Target**: 100-200 lines per PR (optimal for review quality)
- **Maximum**: 300 lines per PR (hard limit)
- Prioritize logical cohesion and reviewability over strict line counts
- Count only meaningful code changes (exclude generated files, formatting)

## PR Template Compliance

### For liam-hq/liam Projects
Follow the standard template structure:
- **Issue**: Link to related issue (`- resolve: #123`)
- **Why is this change needed?**: Brief explanation of necessity
- **What would you like reviewers to focus on?**: Specific review points
- **Testing Verification**: How changes were verified locally
- **What was done**: Auto-generated by PR-Agent
- **Additional Notes**: Any extra context for reviewers

### For route06/pj-tls-forwarder Projects
Follow the Japanese template structure:
- **Request**: Copy exact instructions received with source link
- **Issue**: Related issue link or "N/A" if none (`- related: #123`)
- **Description**: Bullet-point modifications and features added
- **Tests**: Manual verification steps as checklist

## Execution Strategy

### 1. Analysis Phase
- Review current changes and identify logical component boundaries
- Map dependencies between components and features
- Separate skeleton elements (structure) from implementation details
- Identify test coverage requirements for each component

### 2. Splitting Strategy
- **PR1 (Skeleton)**: Basic structure, interfaces, types, empty methods, test stubs
- **PR2+ (Implementation)**: Incremental feature implementation with corresponding tests
- **Chain PRs**: PR1 → main, PR2 → PR1, PR3 → PR2, etc.
- Ensure each PR can be reviewed and tested independently

### 3. Implementation Steps
1. **Create skeleton PR** with basic structure and architectural decisions
2. **Propose detailed split plan** with dependencies and test coverage
3. **Get user approval** for the splitting approach and PR sequence
4. **Create branches and PRs** in dependency order
5. **Write template-compliant descriptions** for each PR
6. **Create all PRs as Draft** initially to prevent premature reviews

### 4. Quality Gates
- Each PR must include relevant tests (unit/integration as appropriate)
- Verify template compliance before PR creation
- Ensure independent reviewability of each PR
- Confirm size constraints are met (100-200 lines ideal, 300 max)
- Validate that skeleton PR enables meaningful architectural review

## Advanced Considerations

### Dependency Management
- Clearly document inter-PR dependencies in descriptions
- Use feature flags or interfaces to decouple when necessary
- Ensure each PR builds and tests pass independently

### Test Strategy
- Include test stubs in skeleton PR to establish testing approach
- Pair implementation PRs with comprehensive test coverage
- Follow project-specific testing patterns and conventions
- Maintain test-to-code ratio appropriate for the change type

### Review Optimization
- Structure PRs to enable focused, domain-specific reviews
- Include context and rationale in PR descriptions
- Highlight areas requiring special attention or architectural decisions
- Provide clear acceptance criteria for each PR

## Important Notes

- All split PRs start as **Draft Pull Requests**
- Convert to "Ready for review" only after all dependent PRs are created
- Focus on logical cohesion over strict adherence to line count limits
- Maintain clear commit messages and comprehensive PR descriptions
- Ensure skeleton PR provides sufficient context for architectural feedback
- Follow project-specific branching and review conventions

$ARGUMENTS
